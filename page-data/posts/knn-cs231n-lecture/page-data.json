{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/knn-cs231n-lecture","result":{"data":{"markdownRemark":{"html":"<h2>필요 라이브러리 호출</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> operator\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> pickle\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">%</span>matplotlib inline</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">CIFAR_DATASETS_PATH <span class=\"token operator\">=</span> <span class=\"token string\">\"./cifar-10-batches-py/\"</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># CIFAR-10 Data 위치 찾음</span>\nfileList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> <span class=\"token builtin\">file</span> <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>CIFAR_DATASETS_PATH<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    fileList<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>CIFAR_DATASETS_PATH <span class=\"token operator\">+</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 0 -> label</span>\n<span class=\"token comment\"># 1:5 -> Train Set</span>\n<span class=\"token comment\"># 7 -> Test Set</span>\nLabelData <span class=\"token operator\">=</span> fileList<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\nTrainDatasets <span class=\"token operator\">=</span> fileList<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\nTestDatasets <span class=\"token operator\">=</span> fileList<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>LabelData<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>TrainDatasets<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>TestDatasets<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./cifar-10-batches-py/batches.meta\n['./cifar-10-batches-py/data_batch_1', './cifar-10-batches-py/data_batch_2', './cifar-10-batches-py/data_batch_3', './cifar-10-batches-py/data_batch_4']\n./cifar-10-batches-py/test_batch</code></pre></div>\n<h1>Helper Functions</h1>\n<p>필요한 함수들</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">load_data</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'bytes'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> data\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">load_multiple_data</span><span class=\"token punctuation\">(</span>fileList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    X<span class=\"token punctuation\">,</span> Y <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> <span class=\"token builtin\">file</span> <span class=\"token keyword\">in</span> fileList<span class=\"token punctuation\">:</span>\n        data <span class=\"token operator\">=</span> load_data<span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span>\n        X<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">b'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        Y<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">b'labels'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>\n\nlabels <span class=\"token operator\">=</span> load_data<span class=\"token punctuation\">(</span>LabelData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">b'label_names'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_object</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> labels\n    <span class=\"token keyword\">return</span> labels<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">view_img</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">'''\n    input\n        X  : 3072 x 1 Array\n    '''</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Xtr<span class=\"token punctuation\">,</span> Ytr <span class=\"token operator\">=</span> load_multiple_data<span class=\"token punctuation\">(</span>TrainDatasets<span class=\"token punctuation\">)</span>\nXte<span class=\"token punctuation\">,</span> Yte <span class=\"token operator\">=</span> load_multiple_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>TestDatasets<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">## 형태 확인</span>\n<span class=\"token comment\"># X_train : 40,000 * 3,072</span>\n<span class=\"token comment\"># Y_train : 40,000 * 1</span>\n<span class=\"token comment\"># X_test  : 10,000 * 3,072</span>\n<span class=\"token comment\"># Y_test  : 10,000 * 1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">,</span> Ytr<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">,</span> Xte<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">,</span> Yte<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(40000, 3072) (40000,) (10000, 3072) (10000,)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">## sample 이미지 확인</span>\ni <span class=\"token operator\">=</span> <span class=\"token number\">100</span> <span class=\"token comment\"># 이미지 확인해볼 index</span>\nview_img<span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nget_object<span class=\"token punctuation\">(</span>Ytr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">b'ship'</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 254px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/124bf711001abdd1cc2acd85a91b6572/6a91e/ship.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/124bf711001abdd1cc2acd85a91b6572/6a91e/ship.png\"\n        srcset=\"/static/124bf711001abdd1cc2acd85a91b6572/12f09/ship.png 148w,\n/static/124bf711001abdd1cc2acd85a91b6572/6a91e/ship.png 254w\"\n        sizes=\"(max-width: 254px) 100vw, 254px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>(k)Nearest Neighbor 클래스 define</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NearestNeighbor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">train</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>Xtr <span class=\"token operator\">=</span> X\n        self<span class=\"token punctuation\">.</span>Ytr <span class=\"token operator\">=</span> Y\n\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">predict</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> X<span class=\"token punctuation\">,</span> k<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        input:\n            X  : N x 3072 shaped numpy array where N indicates the number of images to predict\n            k   : when k > 1, knn\n\n        return:\n            Ypred  : N x 1 numpy array and its element is an integer varying from 0 to 9\n        \"\"\"</span>\n        how_many_to_predict <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n        Y_pred <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token comment\"># create an array length of N (-1 for nothing)</span>\n\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>how_many_to_predict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            distances <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> self<span class=\"token punctuation\">.</span>Xtr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            list_with_labels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">for</span> label<span class=\"token punctuation\">,</span> dist <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>Ytr<span class=\"token punctuation\">,</span> distances<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                list_with_labels<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">,</span> dist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            list_with_labels <span class=\"token operator\">=</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>list_with_labels<span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span>operator<span class=\"token punctuation\">.</span>itemgetter<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">if</span> k <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 1- Nearest Neighbor</span>\n                Y_pred<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> list_with_labels<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># K > 1</span>\n                possible_results <span class=\"token operator\">=</span> list_with_labels<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>k<span class=\"token punctuation\">]</span>\n                result_sets  <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">for</span> label<span class=\"token punctuation\">,</span> dist <span class=\"token keyword\">in</span> possible_results<span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">if</span> label <span class=\"token keyword\">in</span> result_sets<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                        result_sets<span class=\"token punctuation\">[</span>label<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n                    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                        result_sets<span class=\"token punctuation\">[</span>label<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n                result_sets <span class=\"token operator\">=</span> <span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>result_sets<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span>operator<span class=\"token punctuation\">.</span>itemgetter<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                Y_pred<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> result_sets<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token keyword\">return</span> Y_pred</code></pre></div>\n<h4>Accuracy Test Function</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">Accuracy</span><span class=\"token punctuation\">(</span>Y_pred<span class=\"token punctuation\">,</span> Y_real<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    acc <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>Y_pred <span class=\"token operator\">==</span> Y_real<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> verbose<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=================\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Accuracy: {:.1f}%\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>acc <span class=\"token operator\">*</span> <span class=\"token number\">100.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=================\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> acc</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">nn <span class=\"token operator\">=</span> NearestNeighbor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nnn<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">,</span> Ytr<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Test Data 10000개는 너무 오래걸려서 샘플로 테스트</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">randomChoices <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>Xte<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> replace<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">y_pred <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>Xte<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ny_real <span class=\"token operator\">=</span> Yte<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> y1<span class=\"token punctuation\">,</span> y2 <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted: {} \\t\\t\\t Real: {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>get_object<span class=\"token punctuation\">(</span>y1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> get_object<span class=\"token punctuation\">(</span>y2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nAccuracy<span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Predicted: b'cat' \t\t\t Real: b'dog'\nPredicted: b'automobile' \t\t\t Real: b'truck'\nPredicted: b'dog' \t\t\t Real: b'bird'\nPredicted: b'deer' \t\t\t Real: b'cat'\nPredicted: b'deer' \t\t\t Real: b'bird'\n=================\nAccuracy: 0.0%\n=================\n\n\n\n\n\n0.0</code></pre></div>\n<h2>KNN when K > 1</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">y_pred <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>Xte<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ny_real <span class=\"token operator\">=</span> Yte<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> y1<span class=\"token punctuation\">,</span> y2 <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted: {} \\t\\t\\t Real: {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>get_object<span class=\"token punctuation\">(</span>y1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> get_object<span class=\"token punctuation\">(</span>y2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nAccuracy<span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Predicted: b'dog' \t\t\t Real: b'dog'\nPredicted: b'automobile' \t\t\t Real: b'truck'\nPredicted: b'deer' \t\t\t Real: b'bird'\nPredicted: b'frog' \t\t\t Real: b'cat'\nPredicted: b'deer' \t\t\t Real: b'bird'\n=================\nAccuracy: 20.0%\n=================\n\n\n\n\n\n0.20000000000000001</code></pre></div>\n<h2>Train Set에 대한 검증</h2>\n<h4>K = 1 일때 NN의 정확도는 항상 1이 나와야 한다</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">randomChoices <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> size <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> replace<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">y_pred <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ny_real <span class=\"token operator\">=</span> Ytr<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> y1<span class=\"token punctuation\">,</span> y2 <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted: {} \\t\\t\\t Real: {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>get_object<span class=\"token punctuation\">(</span>y1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> get_object<span class=\"token punctuation\">(</span>y2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nAccuracy<span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 항상 100%가 나와야 함</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Predicted: b'bird' \t\t\t Real: b'bird'\nPredicted: b'truck' \t\t\t Real: b'truck'\nPredicted: b'frog' \t\t\t Real: b'frog'\nPredicted: b'deer' \t\t\t Real: b'deer'\nPredicted: b'frog' \t\t\t Real: b'frog'\n=================\nAccuracy: 100.0%\n=================\n\n\n\n\n\n1.0</code></pre></div>\n<h4>K = 5 일 때</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">y_pred <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\ny_real <span class=\"token operator\">=</span> Ytr<span class=\"token punctuation\">[</span>randomChoices<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> y1<span class=\"token punctuation\">,</span> y2 <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Predicted: {} \\t\\t\\t Real: {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>get_object<span class=\"token punctuation\">(</span>y1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> get_object<span class=\"token punctuation\">(</span>y2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nAccuracy<span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> y_real<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Predicted: b'bird' \t\t\t Real: b'bird'\nPredicted: b'truck' \t\t\t Real: b'truck'\nPredicted: b'deer' \t\t\t Real: b'frog'\nPredicted: b'cat' \t\t\t Real: b'deer'\nPredicted: b'ship' \t\t\t Real: b'frog'\n=================\nAccuracy: 40.0%\n=================\n\n\n\n\n\n0.40000000000000002</code></pre></div>\n<h2>Cross Validation</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">Cross_Validations</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">,</span> k_for_KNN<span class=\"token punctuation\">,</span> k_folds <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    chunks <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">//</span> k_folds\n\n    sample <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>sample<span class=\"token punctuation\">)</span>\n\n    results <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># [ (k, mean of acc)]</span>\n    raw <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> k_for_KNN<span class=\"token punctuation\">:</span>\n\n        temp_acc <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span>k_folds<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>k_folds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 0,1,2,3,4 (len = 10, chunks = 2)</span>\n            test_index <span class=\"token operator\">=</span> sample<span class=\"token punctuation\">[</span>i<span class=\"token operator\">*</span>chunks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>chunks<span class=\"token punctuation\">]</span>\n            train_index <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>delete<span class=\"token punctuation\">(</span>sample<span class=\"token punctuation\">,</span> test_index<span class=\"token punctuation\">)</span>\n\n            nn <span class=\"token operator\">=</span> NearestNeighbor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            nn<span class=\"token punctuation\">.</span>train<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">[</span>train_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">)</span>\n            y_pred <span class=\"token operator\">=</span> nn<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">)</span>\n\n            acc <span class=\"token operator\">=</span> Accuracy<span class=\"token punctuation\">(</span>y_pred<span class=\"token punctuation\">,</span> Y<span class=\"token punctuation\">[</span>test_index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n            temp_acc<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span> acc\n            raw<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span> acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        results<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>temp_acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>raw<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">how_many_folds <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\nresults<span class=\"token punctuation\">,</span> raw <span class=\"token operator\">=</span> Cross_Validations<span class=\"token punctuation\">(</span>Xtr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Ytr<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k_folds<span class=\"token operator\">=</span>how_many_folds<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>raw<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> raw<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bo'</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">'each dot'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> results<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r-'</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">'Average line'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"K for K-NN\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"Accuracy (%)\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"{}-fold Cross Validation for the best K (of KNN)\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>how_many_folds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmax_index <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Max Accuracy of {:.1f}% when k = {}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">[</span>max_index<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> results<span class=\"token punctuation\">[</span>max_index<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 387px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/df12fd48e28e9624a00b8ac7836317a7/691c3/kfold.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAChUlEQVQ4y6WSz2sTQRTHR0QQBFGIttSLWu+evfTXQQ/6D7TQpNC6hJBrodBDktIilV56liItPVjwEMFLPCoaUCQ/2ppEu7tJN5uSdk027ezvmXky26S2pUXUB1/evHmPz7yZeQgAUCAQuJ5KpW4vLi7eD4VCDwVBGIxGo32RSKRvZGTkcTAYfBSNRvvD4fBAJBIZ4HE4HB6cnJx8MDw8/EQQhIF0Ot27urp6Fa2traF4PN6tadp3x3EMy7KalmXplmW12tJPxSf2bdvmvoExJqVSKYi2t7eRIAh3MMZ1+A+jlIIkSU9RMplECwsL3QcHBypPMMYIY4z+jQDAI4Rw4Djibzg2NnZ3f39/pw2kx09mjPk6vj4lniQcKIriBEIIXUskEj0Y41oHeB7kbPsNlGXZBwZGR0d7McbqUYe85gwINhkQysA0KVDKwDD8UkYIO9HhjVgs1mMYhg+kAJRjOqhmwwHXIQCMQKX4E2zThfqOBZ5LoFY1uWeVskmI68KXz9984JWZ2ci9wma91qi2QMzv0r1KA3ZEDWxNh/WPKuiKBmAbsPF1D8x6EzbSNbD3mrD+SQVH01nmvUrcRgPevvowgVLvXqAt6XXX5sZuTS1jMFsmdbAFqtwCrJsnrmzZzO9cLpvgegyqqg0eAaZUbUIohVz+xwRaWX6Jpqenbul6q9q+psvHoCPG2JEAOh78te8PY8fzPJCkrXGUTL5By8srNw3DwIef9u+DrShKGIVCITQ0NNSVzWanZFmelSQpUSqVZsvlcrxYLM5VKpV4oVCYUxQlls/n50VRnMnlcvOyLCey2exzns9kMnz/2dLSUj9q2wU+4OcJIXQJIXSZT8Qf6i7+AkQlnmIZsNKvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/df12fd48e28e9624a00b8ac7836317a7/691c3/kfold.png\"\n        srcset=\"/static/df12fd48e28e9624a00b8ac7836317a7/12f09/kfold.png 148w,\n/static/df12fd48e28e9624a00b8ac7836317a7/e4a3f/kfold.png 295w,\n/static/df12fd48e28e9624a00b8ac7836317a7/691c3/kfold.png 387w\"\n        sizes=\"(max-width: 387px) 100vw, 387px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nMax Accuracy of 11.3% when k = 10.0</p>","excerpt":"필요 라이브러리 호출 Helper Functions 필요한 함수들  (k)Nearest Neighbor 클래스 define Accuracy Test Function Test Data 10000개는 너무 오래걸려서 샘플로 테스트 KNN when K…","frontmatter":{"date":"July 31, 2016","title":"KNN CS231n Lecture","keywords":"python","description":null},"fields":{"slug":"posts/knn-cs231n-lecture"}}},"pageContext":{"slug":"posts/knn-cs231n-lecture"}},"staticQueryHashes":[]}